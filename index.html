<!DOCTYPE html> <!--김수현-->
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ENS 메인</title>

  <!-- 공통 스타일 시트 (전체 페이지 레이아웃/색상/컴포넌트 스타일) -->
  <link rel="stylesheet" href="style.css">

  <!-- 공통 데이터 스크립트 (playerData, gameData, shopData 등 제공 가정) -->
  <script src="data.js"></script>

  <!-- 상단 검색창 + 결과 박스를 제어하는 스크립트 -->
  <script src="search.js" defer></script>

  <!-- 로그인/로그아웃, 사용자 정보 표시 등을 담당하는 스크립트 -->
  <script src="auth.js" defer></script>

  <!-- 장바구니/구매 기능 등 쇼핑 관련 공통 로직 -->
  <script src="cart.js" defer></script>

  <!-- 탭/필터 상태를 URL 히스토리와 동기화해주는 스크립트 -->
  <script src="tabs-history.js"></script>
</head>
<body>
<!-- ===== 공통 헤더 ===== -->
<div class="header">
  <div class="top-row">
    <!-- 로고: 메인(index.html)으로 이동 -->
    <a href="index.html" class="logo">ENS</a>

    <!-- 상단 전역 검색 입력창 (search.js에서 이벤트를 걸어 사용) -->
    <div class="search-box">
      <input id="globalSearch" type="text" placeholder="검색어를 입력하세요">
    </div>

    <!-- 로그인 상태 / 사용자 이름 / 버튼 등을 표시하는 영역 -->
    <div class="header-user" id="userDisplay"></div>
  </div>

  <!-- 상단 카테고리 네비게이션 버튼 영역 -->
  <div class="categories">
    <!-- 각 버튼은 해당 페이지로 이동하는 간단한 링크 역할 -->
    <button onclick="location.href='index.html'">홈</button>
    <button onclick="location.href='nba.html'">NBA</button>
    <button onclick="location.href='epl.html'">EPL</button>
    <button onclick="location.href='esports.html'">E-스포츠</button>
    <button onclick="location.href='shop.html'">쇼핑</button>
    <button onclick="location.href='community.html'">커뮤니티</button>
    <button onclick="location.href='game.html'">경기</button>
  </div>
</div>

<!-- 검색결과 박스 : 검색 시 이 영역에 결과 카드들이 동적으로 렌더링됨 -->
<div id="searchResultBox" class="search-result-box"></div>

<!-- =============== 메인 배너 =============== -->
<!--
  전체 배너 영역
  - 클릭 시 goShopping() 호출 → shop.html로 이동
  - 좌우 화살표 버튼으로 배너 이미지/텍스트 슬라이드
-->
<div class="main-banner" onclick="goShopping()">
  <!-- 현재 배너 이미지 표시 -->
  <img id="mainBannerImg" src="">
  <!-- 현재 배너 텍스트(프로모션 문구 등) 표시 -->
  <div id="mainBannerText" class="banner-text"></div>

  <!-- 좌측 화살표 버튼
       - 배너 클릭(전체 이동)을 막기 위해 event.stopPropagation() 사용
       - prevBanner() 를 호출해 이전 배너로 이동 -->
  <button class="banner-left" onclick="event.stopPropagation(); prevBanner()">〈</button>

  <!-- 우측 화살표 버튼
       - nextBanner() 를 호출해 다음 배너로 이동 -->
  <button class="banner-right" onclick="event.stopPropagation(); nextBanner()">〉</button>
</div>

<!-- 메인 콘텐츠 영역 (카테고리별 선수 리스트 등) -->
<div id="mainContent" class="main-content-area"></div>

<!-- =============== 메인 배너 슬라이드 + 탭 JS =============== -->
<script>
/* ============================
   메인 배너 슬라이드 관련 데이터
   - 각 항목: 배너 이미지 URL + 표시할 텍스트
============================ */
const bannerData = [
  {
    src:"https://images.unsplash.com/photo-1661951933279-257856cda111?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
    text:"NBA 할인 특가!"
  },
  {
    src:"https://wallpapers.com/images/hd/premier-league-logo-in-blue-op2y0y49xfn7hbh7.jpg",
    text:"EPL 인기 유니폼 세일!"
  },
  {
    src:"https://images.unsplash.com/photo-1633545491399-54a16aa6a871?q=80&w=1472&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
    text:"E-스포츠 장비 기획전!"
  }
];

/* 현재 보여주는 배너 인덱스 (0 ~ bannerData.length-1) */
let bannerIndex = 0;
/* 자동 슬라이드를 위한 타이머 ID (setInterval 반환값) */
let bannerTimer = null;

/**
 * 현재 bannerIndex 를 기준으로
 * mainBannerImg / mainBannerText 요소에 이미지와 텍스트를 반영
 */
function applyBanner() {
  const img = document.getElementById("mainBannerImg");
  const textEl = document.getElementById("mainBannerText");
  // 요소가 없거나 데이터가 없으면 아무 것도 하지 않음
  if (!img || !textEl || !bannerData.length) return;

  const item = bannerData[bannerIndex];
  img.src = item.src;           // 배너 이미지 변경
  textEl.textContent = item.text; // 배너 문구 변경
}

/**
 * 다음 배너로 이동
 * - 인덱스를 하나 증가시키되, 끝에 도달하면 0으로 순환
 */
function nextBanner() {
  if (!bannerData.length) return;
  bannerIndex = (bannerIndex + 1) % bannerData.length;
  applyBanner();
}

/**
 * 이전 배너로 이동
 * - 인덱스를 하나 감소시키되, 0에서 이전으로 가면 마지막 인덱스로 순환
 */
function prevBanner() {
  if (!bannerData.length) return;
  bannerIndex = (bannerIndex - 1 + bannerData.length) % bannerData.length;
  applyBanner();
}

/**
 * 배너 자동 슬라이드 타이머 시작
 * - 5초마다 nextBanner() 호출
 * - 이미 타이머가 있다면 기존 타이머를 먼저 정리(clearInterval)
 */
function startBannerTimer() {
  if (bannerTimer) clearInterval(bannerTimer);
  bannerTimer = setInterval(nextBanner, 5000);
}

/**
 * 배너 전체 클릭 시 쇼핑 페이지로 이동
 * - main-banner div 의 onclick 에 연결됨
 */
function goShopping() {
  location.href = "shop.html";
}

/* ============================
   전체(홈) : 모든 카테고리 선수 목록 렌더링
   - playerData 객체 구조:
     {
       "NBA": [ { name, img, ... }, ... ],
       "EPL": [ ... ],
       ...
     }
   - 각 카테고리별로 섹션을 만들고, 가로 스크롤 카드 형태로 선수 출력
============================ */
function renderAllCategories() {
  const box = document.getElementById("mainContent");
  if (!box) return;

  // 기존 내용 초기화
  box.innerHTML = "";

  // playerData의 각 카테고리(cat)를 순회
  for (let cat in playerData) {
    // 섹션 제목(카테고리명) 추가 (예: "NBA", "EPL"...)
    box.innerHTML += `<div class="section-title">${cat}</div>`;

    // 해당 카테고리 선수 리스트
    const list = playerData[cat] || [];
    if (!list.length) {
      // 선수 데이터가 없을 경우 표시할 안내 문구
      box.innerHTML += `
        <div style="padding:24px 8px; opacity:.7;">
          등록된 선수가 없습니다.
        </div>`;
      continue;
    }

    // 가로 스크롤 영역 시작
    let html = `<div class="products-scroll">`;
    list.forEach(p => {
      // 선수 상세 페이지 링크 구성:
      // player.html?cat=카테고리&name=선수이름
      const detailUrl =
        `player.html?cat=${encodeURIComponent(cat)}&name=${encodeURIComponent(p.name)}`;

      // 선수 카드(썸네일 이미지 + 이름)
      html += `
        <a class="product" href="${detailUrl}">
          <img src="${p.img}" alt="${p.name}">
          <div class="product-title">${p.name}</div>
        </a>`;
    });
    // 가로 스크롤 영역 닫기
    html += `</div>`;

    // 메인 콘텐츠 영역에 붙이기
    box.innerHTML += html;
  }
}

/* ============================
   초기화: DOM이 모두 로드된 후 실행
   - 배너 UI 초기 적용 + 자동 슬라이드 시작
   - 메인 콘텐츠(카테고리별 선수 리스트) 렌더링
============================ */
document.addEventListener("DOMContentLoaded", () => {
  // 배너 첫 화면 설정
  applyBanner();
  // 배너 자동 슬라이드 시작
  startBannerTimer();
  // 전체 카테고리별 선수 목록 렌더링
  renderAllCategories();
});
</script>
</body>
</html>
